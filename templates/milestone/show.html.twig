{% extends 'base.html.twig' %}

{% block title %}Milestone{% endblock %}
{% block navbar %}
    {{ include('components/project_navbar.html.twig',{'project_id':milestone.project.id})}}
{% endblock %}
{% block body %}
    <p class="h2">Milestone: {{ milestone.name }}</p>
      
    <div class="hstack gap-3">
        <div class="p-2">Prevu le {{ milestone.dueDate ? milestone.dueDate|date('Y-m-d') : '' }}</div>
        <div class="p-2">Fini à {{milestone.getProgress()}}%</div>
        <div class="p-2">Poids attribués: {{milestone.getMilestoneWeight}}% ({{milestone.rate}} points sur {{milestone.project.getMilestonesWeight}})</div>
    </div>

    <div class="clearfix mt-5">
        <p class="h4 float-start">Listes des taches</p>
        <a href="{{path('app_task_new',{'id':milestone.id})}}" class="btn float-end">Ajouter une tache</a>
    </div>
        {{ include('task/_tasks_list.html.twig',{'tasks':milestone.tasks})}}
        {% if is_granted('ROLE_ADMIN') %}
            <a href="{{ path('app_milestone_edit', {'id': milestone.id}) }}" class="btn link-primary">Modifier le milestone</a>
            <form method="post" action="{{ path('app_milestone_delete', {'id': milestone.id}) }}" onsubmit="return confirm('Are you sure you want to delete this item?');">
                <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ milestone.id) }}">
                <button class="btn text-danger">Supprimer le milestone.</button>
            </form>
        {% endif %}
{% endblock %}
